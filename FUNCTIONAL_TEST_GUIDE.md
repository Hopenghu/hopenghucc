# 🧪 TripPlanner 功能測試指南

> **目的**: 全面測試 TripPlanner 功能  
> **優先級**: P0

---

## 📋 測試環境

- **網站**: https://www.hopenghu.cc/trip-planner
- **需要**: 已登入帳號
- **工具**: 瀏覽器開發者工具（F12）

---

## 🧪 測試項目

### 1. 載入行程功能測試 ⭐

#### 測試步驟

1. **創建測試行程**
   - 訪問: https://www.hopenghu.cc/trip-planner
   - 添加至少 2-3 個地點到行程
   - 調整地點順序（拖拽）
   - 設置時間
   - 點擊「儲存行程」
   - 記錄行程 ID（從 Console 或 Network 標籤）

2. **測試載入按鈕**
   - 重新整理頁面
   - 點擊「載入行程」按鈕
   - 應該看到行程列表
   - 選擇剛才創建的行程
   - 確認行程正確載入

3. **測試 URL 參數載入**
   - 訪問: `https://www.hopenghu.cc/trip-planner?id=<行程ID>`
   - 行程應該自動載入
   - 確認所有地點、順序、時間都正確

#### 預期結果

- ✅ 行程列表正確顯示
- ✅ 選擇行程後正確載入
- ✅ 地點、順序、時間都正確
- ✅ 地圖標記正確顯示
- ✅ URL 參數載入正常工作

---

### 2. 路線規劃功能測試 ⭐

#### 測試步驟

1. **基本路線測試**
   - 添加至少 2 個地點到同一天
   - 觀察地圖是否顯示藍色路線
   - 確認路線按照地點順序連接

2. **路線更新測試**
   - 拖拽地點改變順序
   - 確認路線自動更新
   - 添加更多地點
   - 確認路線包含所有地點

3. **多天路線測試**
   - 添加多天行程
   - 在不同天添加地點
   - 切換天數標籤
   - 確認路線只顯示當前天的地點

4. **錯誤處理測試**
   - 打開 Console（F12）
   - 檢查是否有 Directions API 錯誤
   - 如果 API 失敗，應該使用降級方案（簡單折線）

#### 預期結果

- ✅ 路線在地圖上正確顯示
- ✅ 路線按照地點順序連接
- ✅ 拖拽後路線自動更新
- ✅ 多天行程路線正確
- ✅ Console 沒有 Directions API 錯誤

---

### 3. 地點管理功能測試

#### 測試步驟

1. **添加地點**
   - 點擊地圖上的 POI 標記
   - 確認地點添加到行程面板
   - 確認地圖上顯示標記

2. **移除地點**
   - 點擊地點的「刪除」按鈕
   - 確認地點從行程中移除
   - 確認地圖標記消失
   - 確認路線更新

3. **拖拽排序**
   - 在同一天內拖拽地點
   - 確認順序改變
   - 確認路線更新
   - 確認標記編號更新

4. **時間設置**
   - 修改地點時間
   - 確認時間保存
   - 確認排序按時間

#### 預期結果

- ✅ 地點正確添加
- ✅ 地點正確移除
- ✅ 拖拽排序正常工作
- ✅ 時間設置保存

---

### 4. 儲存和分享功能測試

#### 測試步驟

1. **儲存行程**
   - 創建行程
   - 點擊「儲存行程」
   - 確認顯示成功訊息
   - 確認「儲存行程」按鈕變為「更新行程」

2. **更新行程**
   - 修改已儲存的行程
   - 點擊「更新行程」
   - 確認更新成功

3. **分享行程**
   - 點擊「分享行程」
   - 複製分享連結
   - 在新視窗/無痕模式打開連結
   - 確認行程正確顯示（無需登入）

#### 預期結果

- ✅ 行程正確儲存
- ✅ 行程正確更新
- ✅ 分享連結正常工作
- ✅ 分享頁面正確顯示

---

## 🔍 檢查清單

### Directions API 配置

- [ ] Directions API 已在 Google Cloud Console 啟用
- [ ] API Key 的「API restrictions」包含 Directions API
- [ ] 「Application restrictions」允許 `*.hopenghu.cc/*`（如果設置了）
- [ ] 計費帳戶已啟用（如果需要）

### 功能測試

- [ ] 載入行程功能正常
- [ ] URL 參數載入正常
- [ ] 路線規劃功能正常
- [ ] 路線自動更新正常
- [ ] 多天行程路線正確
- [ ] 地點管理功能正常
- [ ] 儲存和分享功能正常

### Console 檢查

- [ ] 沒有 Directions API 錯誤
- [ ] 沒有其他 JavaScript 錯誤
- [ ] 沒有 CSP 違規錯誤
- [ ] 沒有網路請求失敗

---

## 📝 測試報告

### 測試結果

| 功能 | 狀態 | 備註 |
|------|------|------|
| 載入行程 | ⬜ | |
| URL 參數載入 | ⬜ | |
| 路線規劃 | ⬜ | |
| 路線更新 | ⬜ | |
| 多天行程 | ⬜ | |
| 地點管理 | ⬜ | |
| 儲存行程 | ⬜ | |
| 分享行程 | ⬜ | |

### Console 錯誤

- [ ] 無錯誤
- [ ] 有錯誤（請記錄）

### 發現的問題

1. _________________________________
2. _________________________________
3. _________________________________

---

## 🔧 故障排除

### 問題：路線不顯示

**檢查**:
1. Console 是否有 `REQUEST_DENIED` 錯誤
2. 是否至少添加了 2 個地點
3. 地點是否有正確的坐標

**解決**:
- 如果看到 `REQUEST_DENIED`，檢查 API Key 權限
- 確認 Directions API 已啟用
- 檢查 API Key 的「API restrictions」

### 問題：載入行程失敗

**檢查**:
1. Network 標籤中的 API 請求
2. Console 是否有錯誤
3. 行程 ID 是否正確

**解決**:
- 檢查 API 端點是否正常
- 確認資料庫連接正常
- 檢查用戶權限

---

**下一步**: 執行測試並填寫測試報告

