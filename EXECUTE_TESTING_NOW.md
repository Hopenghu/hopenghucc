# 🚀 立即執行功能測試

> **狀態**: 所有配置已完成，準備測試  
> **優先級**: P0

---

## ✅ 已確認的配置

- [x] Directions API 已啟用
- [x] API Key 的「API restrictions」包含 Directions API
- [x] 所有 Secrets 已設置
- [x] 網站正常運行（HTTP 200）
- [x] API 端點可訪問

---

## 🧪 立即執行測試

### 步驟 1: 打開測試頁面

1. **訪問**: https://www.hopenghu.cc/trip-planner
2. **登入**（如果尚未登入）
3. **打開開發者工具**:
   - 按 `F12` 或右鍵 → 檢查
   - 切換到「**Console**」標籤
   - 可選：切換到「**Network**」標籤（查看 API 請求）

---

### 步驟 2: 測試路線規劃功能 ⭐ **最重要**

#### 2.1 添加地點

1. **點擊地圖上的 POI 標記**（藍色圖標）
2. 應該看到地點詳情面板
3. 點擊「加入行程」或類似按鈕
4. 重複添加**至少 2 個地點**

#### 2.2 檢查路線

**觀察地圖**:
- ✅ 應該看到**藍色路線**連接地點
- ✅ 路線應該按照地點的順序顯示

**檢查 Console**:
- ✅ **不應該看到** `REQUEST_DENIED` 錯誤
- ✅ **不應該看到** `This API key is not authorized` 錯誤
- ✅ **不應該看到** Directions API 相關錯誤

**如果看到錯誤**:
- ❌ `REQUEST_DENIED` → 檢查 API Key 權限
- ❌ `This API key is not authorized` → 檢查 API 啟用狀態
- ⚠️ 使用降級方案（簡單折線）→ Directions API 未正常工作

#### 2.3 測試路線更新

1. **拖拽排序**: 在行程面板中拖拽地點改變順序
2. **觀察**: 路線應該自動更新
3. **添加地點**: 添加第 3 個地點
4. **觀察**: 路線應該包含所有地點

---

### 步驟 3: 測試載入行程功能 ⭐ **重點測試**

#### 3.1 創建測試行程

1. **添加 2-3 個地點**到行程
2. **調整順序**（拖拽）
3. **設置時間**（可選）
4. **點擊「儲存行程」**
5. **記錄行程 ID**（從 Console 或 Network 標籤）

#### 3.2 測試載入按鈕

1. **重新整理頁面**（`F5` 或 `Cmd+R`）
2. **點擊「載入行程」按鈕**
3. **應該看到行程列表彈窗**
4. **選擇剛才創建的行程**
5. **確認**:
   - ✅ 行程正確載入
   - ✅ 所有地點、順序、時間都正確
   - ✅ 地圖標記正確顯示
   - ✅ **路線正確顯示**（如果已添加 2+ 地點）

#### 3.3 測試 URL 參數載入

1. **從 Console 或 Network 標籤獲取行程 ID**
2. **訪問**: `https://www.hopenghu.cc/trip-planner?id=<行程ID>`
3. **確認**:
   - ✅ 行程自動載入
   - ✅ 不需要點擊「載入行程」按鈕
   - ✅ 所有資料正確

---

### 步驟 4: 測試多天行程

1. **點擊「+ 新增一天」按鈕**
2. **在不同天添加地點**
3. **切換天數標籤**
4. **確認**:
   - ✅ 路線只顯示當前天的地點
   - ✅ 切換天數後路線更新

---

## 📊 測試結果記錄

### 路線規劃功能

- [ ] 路線在地圖上顯示
- [ ] Console 沒有 Directions API 錯誤
- [ ] 路線按照正確順序連接
- [ ] 拖拽後路線自動更新

### 載入行程功能

- [ ] 行程列表顯示
- [ ] 可以選擇行程
- [ ] 行程正確載入
- [ ] URL 參數載入正常

### Console 錯誤

- [ ] 無錯誤
- [ ] 有錯誤（請記錄錯誤訊息）

---

## 🔍 關鍵檢查點

### 1. Directions API 是否正常工作

**檢查方法**:
- 添加 2+ 地點後，地圖上是否顯示藍色路線
- Console 是否有 `REQUEST_DENIED` 錯誤

**預期結果**:
- ✅ 路線顯示
- ✅ 無錯誤

### 2. 載入行程功能是否正常

**檢查方法**:
- 儲存行程後，重新整理頁面
- 點擊「載入行程」，選擇行程
- 確認所有資料正確載入

**預期結果**:
- ✅ 行程列表顯示
- ✅ 行程正確載入
- ✅ 路線正確顯示

---

## 📝 快速測試流程

```
1. 訪問 https://www.hopenghu.cc/trip-planner
2. 打開開發者工具（F12）→ Console
3. 添加 2 個地點
   → 檢查：路線是否顯示？
   → 檢查：Console 是否有錯誤？
4. 儲存行程
   → 記錄行程 ID
5. 重新整理頁面
6. 點擊「載入行程」
   → 選擇剛才創建的行程
   → 檢查：行程是否正確載入？
   → 檢查：路線是否顯示？
7. 測試 URL 參數載入
   → 訪問：/trip-planner?id=<行程ID>
   → 檢查：是否自動載入？
```

---

## ⚠️ 如果遇到問題

### 問題：路線不顯示

**可能原因**:
1. Directions API 未正確啟用
2. API Key 權限不足
3. 需要等待 API 設置生效（1-2 分鐘）

**解決方案**:
1. 檢查 Console 是否有錯誤
2. 確認 API Key 權限包含 Directions API
3. 等待 1-2 分鐘後重試
4. 清除瀏覽器快取

### 問題：載入行程失敗

**可能原因**:
1. API 端點問題
2. 資料庫連接問題
3. 用戶權限問題

**解決方案**:
1. 檢查 Network 標籤中的 API 請求
2. 檢查 Console 是否有錯誤
3. 確認已登入

---

## 📚 相關文檔

- `BROWSER_TEST_CHECKLIST.md` - 詳細的瀏覽器測試檢查清單
- `FUNCTIONAL_TEST_GUIDE.md` - 完整功能測試指南
- `DIRECTIONS_API_CHECKLIST.md` - Directions API 檢查清單

---

**現在開始測試**: 訪問 https://www.hopenghu.cc/trip-planner 並執行上述測試步驟

